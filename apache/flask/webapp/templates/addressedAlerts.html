{% extends 'base.html' %}

{% block content %}

<section>
<div class="container">
	<h2>Alerting Table</h2>
	<p>These are alerts generated by Sweet Security</p>
	<table class="table table-condensed">
		<thead>
			<tr>
				<th>Source</th>
				<th>Message</th>
				<th>Device</th>
				<th>Date</th>
				<th>Addressed On</th>
			</tr>
		</thead>
		<tbody>
{% for alert in myAlerts %}
			<tr>
				<td>{{alert['_source']['source']|safe}}</td>
				<td>{{alert['_source']['message']|safe}}</td>
				<td>{{alert['_source']['mac']|safe}}</td>
				<td>{{alert['_source']['firstSeen']|safe}}</td>
				<td>{{alert['_source']['addressedDate']|safe}}</td>
			</tr>
{% endfor %}
		</tbody>
	</table>
</div>

<script>
function addressAlert(checkboxElem,logID) {
  $.post('/alerts/address',
      { 
        'logID': logID,
        'csrf_token': '{{ csrf_token() }}'
      },
      function (response, status) {
        window.location.reload();
      }
    );
}

function switchframe(id) {
   document.getElementsByName('iframe_1').contentWindow.switchTabInIframe(id);
}
</script>

</section>

{% endblock %}
